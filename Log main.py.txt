Log main.py
(venv) PS D:\Doc\File python\Finanza\Certificates\Revisione2> & "D:/Doc/File python/Finanza/Certificates/Revisione2/venv/Scripts/python.exe" "d:/Doc/File python/Finanza/Certificates/Revisione2/src/main.py"
âœ… Import sistema esistente OK
âœ… Import enhanced manager v15 OK
Avvio dell'applicazione Certificati Finanziari...
2025-07-04 15:58:18,000 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:58:18,000 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:18,001 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:18,001 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:18,001 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:18,001 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:18,001 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:18,001 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
âœ… Enhanced Manager v15 inizializzato per calc date
2025-07-04 15:58:18,007 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:18,008 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:58:18,008 - INFO - Caricati 2 portafogli
2025-07-04 15:58:18,008 - INFO - Caricati positions per 1 portafogli
2025-07-04 15:58:18,009 - INFO - Portfolio Manager inizializzato
âœ… Portfolio Manager e GUI Manager inizializzati direttamente nella GUI principale.
ğŸ“‚ Caricamento 5 certificati...
ğŸ”„ Conversion v15.1 for IT0006767872
ğŸ”„ Conversion v15.1 for XS3031184206
ğŸ”„ Conversion v15.1 for DE000VK2NM23
ğŸ”„ Conversion v15.1 for XS2902921233
ğŸ”„ Conversion v15.1 for XS2705561756
âœ… Caricati 5 certificati da src\app\data\certificates.json
ğŸš€ === GUI MANAGER v15.1 CORRECTED INIZIALIZZATO ===
ğŸšª Chiusura GUI Certificate Manager v15.1 CORRECTED
Applicazione terminata.
(venv) PS D:\Doc\File python\Finanza\Certificates\Revisione2> & "D:/Doc/File python/Finanza/Certificates/Revisione2/venv/Scripts/python.exe" "d:/Doc/File python/Finanza/Certificates/Revisione2/src/main.py"
âœ… Import sistema esistente OK
âœ… Import enhanced manager v15 OK
Avvio dell'applicazione Certificati Finanziari...
2025-07-04 15:58:53,111 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:58:53,111 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:53,112 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:53,112 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:53,112 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:53,112 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:53,112 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:53,112 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
âœ… Enhanced Manager v15 inizializzato per calc date
2025-07-04 15:58:53,121 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:53,122 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:58:53,122 - INFO - Caricati 2 portafogli
2025-07-04 15:58:53,123 - INFO - Caricati positions per 1 portafogli
2025-07-04 15:58:53,123 - INFO - Portfolio Manager inizializzato
âœ… Portfolio Manager e GUI Manager inizializzati direttamente nella GUI principale.
ğŸ“‚ Caricamento 5 certificati...
ğŸ”„ Conversion v15.1 for IT0006767872
ğŸ”„ Conversion v15.1 for XS3031184206
ğŸ”„ Conversion v15.1 for DE000VK2NM23
ğŸ”„ Conversion v15.1 for XS2902921233
ğŸ”„ Conversion v15.1 for XS2705561756
âœ… Caricati 5 certificati da src\app\data\certificates.json
ğŸš€ === GUI MANAGER v15.1 CORRECTED INIZIALIZZATO ===
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Users\namad\AppData\Local\Programs\Python\Python313\Lib\tkinter\__init__.py", line 2068, in __call__
    return self.func(*args)
           ~~~~~~~~~^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1307, in _on_selection_changed
    self._display_certificate_details(cert_id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1346, in _display_certificate_details
    note_barriere = cert_data.get('note_barriere', '').strip()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'strip'
2025-07-04 15:58:58,668 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:58:58,668 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:58,668 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:58,669 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:58,669 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:58:58,669 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:58:58,669 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:58:58,670 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
ğŸ†• Aggiunta certificato v15: DE000VK2NM23
   Dati ricevuti: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
   ğŸ“Š Yahoo ticker specificato: BMW.DE, MBG.DE,STLAM.MI,VOW.DE
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
ğŸ“Š Auto-updating market data per DE000VK2NM23...
ğŸ” DEBUG v16.1 - PRIMA del fetch Yahoo:
   Current spots: Non definiti
ğŸ“Š Fetch market data per 5 assets...
ğŸ“Š Usando ticker specificato per Bayerische Motoren Werke AG: BMW.DE, MBG.DE,STLAM.MI,VOW.DE
   ğŸ”„ Downloading Bayerische Motoren Werke AG (BMW.DE, MBG.DE,STLAM.MI,VOW.DE)...
2025-07-04 15:59:00,135 - ERROR - $BMW.DE, MBG.DE,STLAM.MI,VOW.DE: possibly delisted; no price data found  (1d 2024-10-25 15:58:58.679746 -> 2025-07-04 15:58:58.679755) (Yahoo error = "No data found, symbol may be delisted")
   âš ï¸  Nessun dato per Bayerische Motoren Werke AG (BMW.DE, MBG.DE,STLAM.MI,VOW.DE)
ğŸ“Š Ticker fallback per Mercedes-Benz Group AG: Mercedes-Benz Group AG
   ğŸ”„ Downloading Mercedes-Benz Group AG (Mercedes-Benz Group AG)...
2025-07-04 15:59:00,854 - ERROR - HTTP Error 404: 
2025-07-04 15:59:01,094 - ERROR - $MERCEDES-BENZ GROUP AG: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Mercedes-Benz Group AG (Mercedes-Benz Group AG)
ğŸ“Š Ticker fallback per :
   ğŸ”„ Downloading  ()...
   âŒ Errore fetch : Empty ticker name
ğŸ“Š Ticker fallback per Stellantis N.V.: Stellantis N.V.
   ğŸ”„ Downloading Stellantis N.V. (Stellantis N.V.)...
2025-07-04 15:59:01,845 - ERROR - HTTP Error 404: 
2025-07-04 15:59:02,027 - ERROR - $STELLANTIS N.V.: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Stellantis N.V. (Stellantis N.V.)
ğŸ“Š Ticker fallback per Volkswagen AG: Volkswagen AG
   ğŸ”„ Downloading Volkswagen AG (Volkswagen AG)...
2025-07-04 15:59:02,376 - ERROR - $VOLKSWAGEN AG: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Volkswagen AG (Volkswagen AG)
ğŸ“Š Fetch completato: 0/5 successi
ğŸ” DEBUG v16.1 - DOPO il fetch Yahoo:
   Dati scaricati spots: {}
âŒ Nessun dato market recuperato
âš ï¸  Alcuni dati market falliti, usando defaults
ğŸ”„ Backup creato: certificates.backup_20250704_155902.json
ğŸ’¾ Configurazioni v15 salvate: 5 certificati
âœ… Certificato enhanced DE000VK2NM23 aggiunto (v15)
2025-07-04 15:59:02,394 - INFO - UnifiedRiskAnalyzer inizializzato
Traceback (most recent call last):
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1639, in _export_analysis_excel
    risk_metrics = analyzer.analyze_certificate_risk(real_config)
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\core\consolidated_risk_system.py", line 288, in analyze_certificate_risk
    certificate.specs.isin,
    ^^^^^^^^^^^^^^^^^
AttributeError: 'EnhancedCertificateConfig' object has no attribute 'specs'
ğŸšª Chiusura GUI Certificate Manager v15.1 CORRECTED
Applicazione terminata.
(venv) PS D:\Doc\File python\Finanza\Certificates\Revisione2> & "D:/Doc/File python/Finanza/Certificates/Revisione2/venv/Scripts/python.exe" "d:/Doc/File python/Finanza/Certificates/Revisione2/src/main.py"
âœ… Import sistema esistente OK
âœ… Import enhanced manager v15 OK
Avvio dell'applicazione Certificati Finanziari...
2025-07-04 15:59:52,538 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:59:52,538 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:59:52,538 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:59:52,538 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:59:52,538 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:59:52,539 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:59:52,539 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:59:52,539 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
âœ… Enhanced Manager v15 inizializzato per calc date
2025-07-04 15:59:52,544 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:59:52,545 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:59:52,545 - INFO - Caricati 2 portafogli
2025-07-04 15:59:52,545 - INFO - Caricati positions per 1 portafogli
2025-07-04 15:59:52,545 - INFO - Portfolio Manager inizializzato
âœ… Portfolio Manager e GUI Manager inizializzati direttamente nella GUI principale.
ğŸ“‚ Caricamento 5 certificati...
ğŸ”„ Conversion v15.1 for IT0006767872
ğŸ”„ Conversion v15.1 for XS3031184206
ğŸ”„ Conversion v15.1 for DE000VK2NM23
ğŸ”„ Conversion v15.1 for XS2902921233
ğŸ”„ Conversion v15.1 for XS2705561756
âœ… Caricati 5 certificati da src\app\data\certificates.json
ğŸš€ === GUI MANAGER v15.1 CORRECTED INIZIALIZZATO ===
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Users\namad\AppData\Local\Programs\Python\Python313\Lib\tkinter\__init__.py", line 2068, in __call__
    return self.func(*args)
           ~~~~~~~~~^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1307, in _on_selection_changed
    self._display_certificate_details(cert_id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1346, in _display_certificate_details
    note_barriere = cert_data.get('note_barriere', '').strip()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'strip'
2025-07-04 15:59:56,832 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 15:59:56,832 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:59:56,833 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:59:56,833 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:59:56,833 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 15:59:56,834 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 15:59:56,834 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 15:59:56,834 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
ğŸ†• Aggiunta certificato v15: XS2705561756
   Dati ricevuti: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
   ğŸ“Š Yahoo ticker specificato: ^GSPC, ^STOXX50E, ^N225
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
ğŸ“Š Auto-updating market data per XS2705561756...
ğŸ” DEBUG v16.1 - PRIMA del fetch Yahoo:
   Current spots: Non definiti
ğŸ“Š Fetch market data per 3 assets...
ğŸ“Š Usando ticker specificato per S&P 500: ^GSPC, ^STOXX50E, ^N225
   ğŸ”„ Downloading S&P 500 (^GSPC, ^STOXX50E, ^N225)...
2025-07-04 15:59:57,788 - ERROR - HTTP Error 404: 
2025-07-04 15:59:58,328 - ERROR - $^GSPC, ^STOXX50E, ^N225: possibly delisted; no price data found  (1d 2024-10-25 15:59:56.842985 -> 2025-07-04 15:59:56.843001) (Yahoo error = "No data found, symbol may be delisted")
   âš ï¸  Nessun dato per S&P 500 (^GSPC, ^STOXX50E, ^N225)
ğŸ“Š Ticker fallback per EURO STOXX 50: EURO STOXX 50
   ğŸ”„ Downloading EURO STOXX 50 (EURO STOXX 50)...
2025-07-04 15:59:58,936 - ERROR - HTTP Error 404: 
2025-07-04 15:59:59,124 - ERROR - $EURO STOXX 50: possibly delisted; no timezone found
   âš ï¸  Nessun dato per EURO STOXX 50 (EURO STOXX 50)
ğŸ“Š Ticker fallback per NIKKEI 225: NIKKEI 225
   ğŸ”„ Downloading NIKKEI 225 (NIKKEI 225)...
2025-07-04 15:59:59,462 - ERROR - $NIKKEI 225: possibly delisted; no timezone found
   âš ï¸  Nessun dato per NIKKEI 225 (NIKKEI 225)
ğŸ“Š Fetch completato: 0/3 successi
ğŸ” DEBUG v16.1 - DOPO il fetch Yahoo:
   Dati scaricati spots: {}
âŒ Nessun dato market recuperato
âš ï¸  Alcuni dati market falliti, usando defaults
ğŸ”„ Backup creato: certificates.backup_20250704_155959.json
ğŸ’¾ Configurazioni v15 salvate: 5 certificati
âœ… Certificato enhanced XS2705561756 aggiunto (v15)
2025-07-04 15:59:59,471 - INFO - UnifiedRiskAnalyzer inizializzato
Traceback (most recent call last):
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1639, in _export_analysis_excel
    risk_metrics = analyzer.analyze_certificate_risk(real_config)
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\core\consolidated_risk_system.py", line 288, in analyze_certificate_risk
    certificate.specs.isin,
    ^^^^^^^^^^^^^^^^^
AttributeError: 'EnhancedCertificateConfig' object has no attribute 'specs'
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Users\namad\AppData\Local\Programs\Python\Python313\Lib\tkinter\__init__.py", line 2068, in __call__
    return self.func(*args)
           ~~~~~~~~~^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1307, in _on_selection_changed
    self._display_certificate_details(cert_id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1346, in _display_certificate_details
    note_barriere = cert_data.get('note_barriere', '').strip()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'strip'
2025-07-04 16:00:10,027 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 16:00:10,027 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 16:00:10,028 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 16:00:10,028 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 16:00:10,028 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 16:00:10,028 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 16:00:10,028 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 16:00:10,029 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
ğŸ†• Aggiunta certificato v15: IT0006767872
   Dati ricevuti: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
   ğŸ“Š Yahoo ticker specificato: DBK.DE,GLE.PA,UCG.MI,BIMI.MI
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
ğŸ“Š Auto-updating market data per IT0006767872...
ğŸ” DEBUG v16.1 - PRIMA del fetch Yahoo:
   Current spots: Non definiti
ğŸ“Š Fetch market data per 4 assets...
ğŸ“Š Usando ticker specificato per Deutsche Bank AG: DBK.DE,GLE.PA,UCG.MI,BIMI.MI
   ğŸ”„ Downloading Deutsche Bank AG (DBK.DE,GLE.PA,UCG.MI,BIMI.MI)...
2025-07-04 16:00:10,347 - ERROR - $DBK.DE,GLE.PA,UCG.MI,BIMI.MI: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Deutsche Bank AG (DBK.DE,GLE.PA,UCG.MI,BIMI.MI)
ğŸ“Š Ticker fallback per SocietÃ  Generale: SocietÃ  Generale
   ğŸ”„ Downloading SocietÃ  Generale (SocietÃ  Generale)...
2025-07-04 16:00:10,868 - ERROR - $SOCIETÃ€ GENERALE: possibly delisted; no timezone found
   âš ï¸  Nessun dato per SocietÃ  Generale (SocietÃ  Generale)
ğŸ“Š Ticker fallback per Unicredit: Unicredit
   ğŸ”„ Downloading Unicredit (Unicredit)...
2025-07-04 16:00:11,239 - ERROR - $UNICREDIT: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Unicredit (Unicredit)
ğŸ“Š Ticker fallback per Banco BPM: Banco BPM
   ğŸ”„ Downloading Banco BPM (Banco BPM)...
2025-07-04 16:00:11,625 - ERROR - $BANCO BPM: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Banco BPM (Banco BPM)
ğŸ“Š Fetch completato: 0/4 successi
ğŸ” DEBUG v16.1 - DOPO il fetch Yahoo:
   Dati scaricati spots: {}
âŒ Nessun dato market recuperato
âš ï¸  Alcuni dati market falliti, usando defaults
ğŸ”„ Backup creato: certificates.backup_20250704_160011.json
ğŸ’¾ Configurazioni v15 salvate: 5 certificati
âœ… Certificato enhanced IT0006767872 aggiunto (v15)
2025-07-04 16:00:11,633 - INFO - UnifiedRiskAnalyzer inizializzato
Traceback (most recent call last):
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1639, in _export_analysis_excel
    risk_metrics = analyzer.analyze_certificate_risk(real_config)
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\core\consolidated_risk_system.py", line 288, in analyze_certificate_risk
    certificate.specs.isin,
    ^^^^^^^^^^^^^^^^^
AttributeError: 'EnhancedCertificateConfig' object has no attribute 'specs'
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Users\namad\AppData\Local\Programs\Python\Python313\Lib\tkinter\__init__.py", line 2068, in __call__
    return self.func(*args)
           ~~~~~~~~~^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1307, in _on_selection_changed
    self._display_certificate_details(cert_id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1346, in _display_certificate_details
    note_barriere = cert_data.get('note_barriere', '').strip()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'strip'
2025-07-04 16:00:19,477 - INFO - EnhancedExcelExporter inizializzato
2025-07-04 16:00:19,478 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 16:00:19,478 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 16:00:19,478 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 16:00:19,478 - INFO - UnifiedRiskAnalyzer inizializzato
2025-07-04 16:00:19,478 - INFO - UnifiedStressTestEngine inizializzato con 7 scenari
2025-07-04 16:00:19,479 - INFO - UnifiedComplianceChecker inizializzato
2025-07-04 16:00:19,479 - INFO - UnifiedRiskDashboard inizializzato
ğŸš€ Sistema Certificati Integrato inizializzato
ğŸ“ Output Excel: D:/Doc/File python/
ğŸ“‚ Caricamento configurazioni v15: 5 certificati
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… IT0006767872 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS3031184206 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… DE000VK2NM23 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2902921233 caricato
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
   âœ… XS2705561756 caricato
ğŸ“Š Portfolio caricati: 2
ğŸš€ Enhanced Certificate Manager v15 inizializzato
   Directory: D:\Doc\File python\Finanza\Certificates\Revisione2\src\app\data
   Certificati: 5
   Portfolio: 2
   Versione: v15 (CORRETTA)
ğŸ†• Aggiunta certificato v15: XS3031184206
   Dati ricevuti: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
   ğŸ“Š Yahoo ticker specificato: STLAM.MI,CPR.MI,NEXI.MI, STMMI.MI
ğŸ”„ === CONVERSIONE SAFE v15.1 (Enhanced Manager) ===
ğŸ“Š Input keys: ['isin', 'name', 'certificate_type', 'issuer', 'issue_date', 'maturity_date', 'notional', 'currency', 'underlying_names', 'yahoo_ticker', 'underlying_currencies', 'underlying_dependency_type', 'risk_free_rate', 'coupon_rate', 'coupon_frequency', 'coupon_dates', 'coupon_rates', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'memory_feature', 'airbag_feature', 'airbag_level', 'airbag_notes', 'dynamic_barrier_feature', 'dynamic_barrier_start_level', 'step_down_rate', 'dynamic_barrier_end_level', 'observation_delay_months', 'certificate_instrument_ticker', 'prezzi_iniziali_sottostanti', 'autocall_levels', 'autocall_dates', 'current_spots', 'volatilities', 'correlations', 'dividend_yields', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp', 'barrier_levels', 'underlying_assets']
ğŸ”§ Campi esclusi v15.1: ['coupon_rate', 'coupon_frequency', 'coupon_barrier', 'coupon_barrier_type', 'capital_barrier', 'capital_barrier_type', 'note_barriere', 'airbag_feature', 'airbag_level', 'airbag_notes', 'observation_delay_months', 'prezzi_iniziali_sottostanti', 'period_rate', 'period_rate_percent', 'annual_equivalent_rate', 'calculation_method', 'calculation_version', 'calculation_timestamp']
âœ… RealCertificateConfig creato (Enhanced Manager v15.1)
ğŸ“Š Campi utilizzati: 29
ğŸ“Š Auto-updating market data per XS3031184206...
ğŸ” DEBUG v16.1 - PRIMA del fetch Yahoo:
   Current spots: Non definiti
ğŸ“Š Fetch market data per 3 assets...
ğŸ“Š Usando ticker specificato per Stellantis NV: STLAM.MI,CPR.MI,NEXI.MI, STMMI.MI
   ğŸ”„ Downloading Stellantis NV (STLAM.MI,CPR.MI,NEXI.MI, STMMI.MI)...
2025-07-04 16:00:19,821 - ERROR - $STLAM.MI,CPR.MI,NEXI.MI, STMMI.MI: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Stellantis NV (STLAM.MI,CPR.MI,NEXI.MI, STMMI.MI)
ğŸ“Š Ticker fallback per Davide campari: Davide campari
   ğŸ”„ Downloading Davide campari (Davide campari)...
2025-07-04 16:00:20,178 - ERROR - $DAVIDE CAMPARI: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Davide campari (Davide campari)
ğŸ“Š Ticker fallback per Nexi StMicroelettronics: Nexi StMicroelettronics
   ğŸ”„ Downloading Nexi StMicroelettronics (Nexi StMicroelettronics)...
2025-07-04 16:00:20,498 - ERROR - $NEXI STMICROELETTRONICS: possibly delisted; no timezone found
   âš ï¸  Nessun dato per Nexi StMicroelettronics (Nexi StMicroelettronics)
ğŸ“Š Fetch completato: 0/3 successi
ğŸ” DEBUG v16.1 - DOPO il fetch Yahoo:
   Dati scaricati spots: {}
âŒ Nessun dato market recuperato
âš ï¸  Alcuni dati market falliti, usando defaults
ğŸ”„ Backup creato: certificates.backup_20250704_160020.json
ğŸ’¾ Configurazioni v15 salvate: 5 certificati
âœ… Certificato enhanced XS3031184206 aggiunto (v15)
2025-07-04 16:00:20,505 - INFO - UnifiedRiskAnalyzer inizializzato
Traceback (most recent call last):
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\ui\main_window.py", line 1639, in _export_analysis_excel
    risk_metrics = analyzer.analyze_certificate_risk(real_config)
  File "d:\Doc\File python\Finanza\Certificates\Revisione2\src\app\core\consolidated_risk_system.py", line 288, in analyze_certificate_risk
    certificate.specs.isin,
    ^^^^^^^^^^^^^^^^^
AttributeError: 'EnhancedCertificateConfig' object has no attribute 'specs'
ğŸšª Chiusura GUI Certificate Manager v15.1 CORRECTED
Applicazione terminata.
(venv) PS D:\Doc\File python\Finanza\Certificates\Revisione2> 